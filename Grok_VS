# File: KILL-ALL-NOW.yaml
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: 000-kill-all-redirect-to-maintenance
  namespace: dev-istio-system          # MUST be same ns as your Gateway
  annotations:
    # This makes Istio evaluate THIS VS before ANY other VS in ANY namespace
    networking.istio.io/exportTo: "*"
spec:
  exportTo:
  - "."
  - "*"
  gateways:
  - epay-dev-gateway                    # EXACT gateway name (no namespace prefix needed here)
  hosts:
  - dev.epay.sbi
  - "*.dev.epay.sbi"
  http:
  - name: "KILL EVERYTHING - MAINTENANCE"
    match:
    - uri:
        prefix: "/"
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080
      weight: 100

[osuser@bastion ~]$ oc apply -f grook-vs.yaml
The VirtualService "zzz-global-maintenance-override" is invalid: spec.http[0].fault.abort.percentage: Invalid value: "integer": spec.http[0].fault.abort.percentage in body must be of type object: "integer"



[osuser@bastion ~]$ oc apply -f grook-vs.yaml
Error from server: error when creating "grook-vs.yaml": admission webhook "rev.validation.istio.io" denied the request: configuration is invalid: cannot have both public (*) and non-public exportTo values for a resource
