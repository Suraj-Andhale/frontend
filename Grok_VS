apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: 000-sbi-maintenance-kill-all
  namespace: dev-istio-system
spec:
  gateways:
  - epay-dev-gateway
  hosts:
  - dev.epay.sbi
  - "*.dev.epay.sbi"
  exportTo:
  - "*"
  http:
  # 1. /ui  (no slash)
  - match:
    - uri:
        exact: /ui
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080

  # 2. /ui/ (with slash) 
  - match:
    - uri:
        prefix: /ui/
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080

  # 3. /demo
  - match:
    - uri:
        exact: /demo
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080

  # 4. /demo/
  - match:
    - uri:
        prefix: /demo/
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080

  # 5. Baki SAB KUCH (root + any other path)
  - match:
    - uri:
        prefix: /
    route:
    - destination:
        host: maintenancefe-maintenance-frontend.dev-frontend.svc.cluster.local
        port:
          number: 8080

[osuser@bastion ~]$ oc apply -f grook-vs.yaml
The VirtualService "zzz-global-maintenance-override" is invalid: spec.http[0].fault.abort.percentage: Invalid value: "integer": spec.http[0].fault.abort.percentage in body must be of type object: "integer"



[osuser@bastion ~]$ oc apply -f grook-vs.yaml
Error from server: error when creating "grook-vs.yaml": admission webhook "rev.validation.istio.io" denied the request: configuration is invalid: cannot have both public (*) and non-public exportTo values for a resource







https://teams.microsoft.com/l/meetup-join/19%3ameeting_MTZkMTFhNTMtZWFiMy00MTM1LTk1YTYtMmNjNGI3MjZkM2U3%40thread.v2/0?context=%7b%22Tid%22%3a%22fbdb2235-7f50-4509-b407-c58325ec27a8%22%2c%22Oid%22%3a%223aca8f16-6e14-4d04-96f7-c4680458f4cc%22%7d
